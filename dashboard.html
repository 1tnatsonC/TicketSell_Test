<!-- Chan Hou Ting Constant (21034774d) & Cheung Kwan Yui (21088966D)-->
<!doctype html>
<html>
  <head>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous" />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"></script>
      <script>
        fetch('/auth/me')
        .then((response) => {
        if (response.ok) {
          return response.json();
        } else {
        throw new Error('Please login');
       }
      })
      .then((data) => {
        if (data.user.username !== "admin") {
          var eventManagementLink = document.getElementById("eventManagement");
          eventManagementLink.style.display = "none";
          var seatManagementLink = document.getElementById("seatManagement");
          seatManagementLink.style.display = "none";
          }
      })
      .catch((error) => {
      console.log(error);
      });

      var idleTimeout = 30*1000;
      var idleTimer;

      function resetTimer() {
        clearTimeout(idleTimer);
        idleTimer = setTimeout(idlelogout, idleTimeout);
      }

      function idlelogout() {
        alert('You have been logged out due to inactivity, please login again.');
        window.location.href = '/login.html';
      }

      document.addEventListener('mousemove', resetTimer);
      document.addEventListener('keypress', resetTimer);
      document.addEventListener('click', resetTimer);

      resetTimer();
    </script>
    <title>Train Ticket Selling System - Event Dashboard</title>
    <script src="js\jquery-3.7.1.min.js"></script>
    <script src="js/index.js"></script>
    <script src="dashboard.js"></script>
  </head>
  <body>
          <header class="text-bg-dark p-3 text-center fw-bold fs-3">
    Train Ticket Selling System
    <h6 id="greeting" class="d-flex justify-content-end"></h4>
  </header>

    <nav class="navbar navbar-expand-lg bg-body-tertiary fw-bold">
      <div class="container-fluid">
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarNavAltMarkup"
          aria-controls="navbarNavAltMarkup"
          aria-expanded="false"
          aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

      <div class="collapse navbar-collapse justify-content-center" id="navbarNavAltMarkup">
        <div class="navbar-nav">
          <a class="nav-link active text-primary m-1" aria-current="page" href="dashboard.html">Event Dashboard</a>
          <a class="nav-link text-body-tertiary m-1" href="booking.html">Ticket Booking</a>
          <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
              <ul class="navbar-nav">
                <li class="nav-item dropdown">
                <button class="nav-link text-body-tertiary m-1 dropdown-toggle" data-bs-toggle="dropdown" aria-expanded="false">My Account</button>
                <ul class="dropdown-menu dropdown-menu-dark">
                  <li><a class="dropdown-item" href="index.html">User Profile</a></li>
                  <li><input class="p-5 m-1 btn btn-secondary" type="button" value="Logout" id="logoutButton" onclick="logout()" /></li>
                </ul>
              </li>
            </ul>
          </div>
          <a
            class="nav-link text-body-tertiary m-1 eventManagement"
            id="eventManagement"
            href="eventManagement.html"
            >Event Management</a
          >
          <a
            class="nav-link text-body-tertiary m-1 seatManagement"
            id="seatManagement"
            href="seatManagement.html"
            >Seat Management</a
          >
        </div>
      </div>
      </div>
    </nav>

    <main>
      <h1>test</h1>
      <h4 id="greeting"></h4>
      <section>
        <div class="container p-4">
          <div class="row mb-3 d-none message alert alert-danger fs-6" id="menuFailed" role="alert"></div>
          <div class="row row-cols-1 row-cols-sm-2 row-cols-md-4" id="event-dashboard"></div>
        </div>

        <p><br /></p>

        <footer class="page-footer fixed-bottom">
          <div class="text-bg-dark p-3 text-center fs-6">
            Â© 21034774d Chan Hou Ting Constant & 21088966d Cheung Kwan Yui - EIE4432 Group Project
          </div>
        </footer>
      </section>
    </main>
  </body>
</html>
